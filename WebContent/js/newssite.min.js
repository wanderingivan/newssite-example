function setUpForm(){$("#addParagraph").click(createInput)}function setVotes(e,t){$("#cID"+e).html(t)}function disableControl(e){$("#upvoteSubmit"+e).prop("disabled",!0),$("#downvoteSubmit"+e).prop("disabled",!0)}function createCookie(e,t,a){if(a){var n=new Date;n.setTime(n.getTime()+24*a*60*60*1e3);var s="; expires="+n.toGMTString()}else var s="";document.cookie=e+"="+t+s+"; path=/"}function readCookie(e){for(var t=e+"=",a=document.cookie.split(";"),n=0;n<a.length;n++){for(var s=a[n];" "==s.charAt(0);)s=s.substring(1,s.length);if(0==s.indexOf(t))return s.substring(t.length,s.length)}return null}function getInputHtml(e){return'<textarea name="product.details['+e+']" id="detailInput" class="form-control" placeholder="Add more details"></textarea>'}function getInputHtml(e){return'<div class="form-group paragraph"><label for="paragraphs['+e+']">Paragraph '+(e+1)+':</label><textarea style="height:250px;" name="articleParagraphs['+e+']" value="" id="paragraphInput"/></div>'}function getTasksHtml(e){return"<li><div id='task"+e.id+"' class='media' style='display:none'><div class='media-body'><p class='media-heading'>"+e.assigner+"</p><p class='text-muted'>"+e.description+"</p><p class='text-muted'>"+e.created+"</p></div></div></li></li><li class='divider'></li>"}function getMessageHtml(e){return"<li><div id='message"+e.id+"' class='media' style='display:none'><div class='media-left'><img src='data:image/jpeg;base64,"+e.sender.imagePath+"'></img></div><div class='media-body'><p class='media-heading'>"+e.sender.username+"</p><p class='text-muted'>"+e.message+"</p><p class='text-muted'>"+e.sent+"</p></div></div></li></li><li class='divider'></li>"}function populateUnreadMessages(){console.log("populating messages");var e=$("#messagesDropdown");$.ajax({url:"/NewsSite/message/unread-messages",dataType:"html",complete:function(e){console.log(e)}}).done(function(t){e.html(t)})}function populatePendingTasks(){var e=$("#dropdownTasks");0===$("#dropdownTasks li").length&&$.getJSON("/NewsSite/admin/pendingTasks",function(t){e.empty(),0==t.tasks.length?(e.html("<li class='divider'></li>"),e.append("<p style='margin-left:15px;color:#22a17d;'>You have no pending tasks</p>")):$.each(t.tasks,function(t,a){e.append(getTasksHtml(a)),$("#task"+a.id).toggle("slide",{direction:"right"},750),$("#task"+a.id).effect("highlight",{color:"rgba(34, 209, 163, 0.5)"},1e3)})})}function getText(e,t){return'"'+e+" said: "+t+'"'}function replyListener(){$(".btn-reply").click(function(){var e=$(this).closest(".media"),t=e.find("#poster").text(),a=e.find("p").text();console.log("Username: "+t),console.log("Text: "+a),$("textarea#message").val(getText(t,a))})}function createInput(){var e=$("#articleForm .form-group.paragraph"),t=getInputHtml(e.length);e.last().after(t)}function loadArticleComments(){$("#loadComments a").click(function(e){var t=$("#headline").val(),a=$("#min").val();$.getJSON("ajaxArticleComments",{headline:t,min:a},function(e){null!=e?$.each(e.comments,function(e){$("#loadComments").append()}):$("#loadComments").empty()})})}function addCookieHandlers(){$.subscribe("checkCookie",function(e,t){var a=e.originalEvent.formData[0].value,n="cID"+a;null!=readCookie(n)&&(e.originalEvent.options.submit=!1,disableControl(a))}),$.subscribe("completeVote",function(e,t){var a=e.originalEvent.request.responseJSON.commentId,n=e.originalEvent.request.responseJSON.votes;createCookie("cID"+a,!0,1),setVotes(a,n),disableControl(a)})}$.ajaxPrefilter(function(e,t,a){var n;return!e.crossDomain&&(n=$('meta[name="_csrf"]').attr("content"))?a.setRequestHeader("X-CSRF-Token",n):void 0}),$(document).ready(function(){$.subscribe("addUnreadCount",function(e,t){var a=JSON.parse(e.originalEvent.data);$("#unread").html(a.unread+" Unread")}),$.subscribe("addTasksCount",function(e,t){var a=JSON.parse(e.originalEvent.data);$("#tasks").html(a.message)}),$.subscribe("loadLog",function(e,t){var a=e.originalEvent.request.responseText;$("#log").html(a)}),$("#dropdownMenuMessages").click(populateUnreadMessages),$("#dropdownMenuTasks").click(populatePendingTasks),$("#msgButton").click(function(){$("#msgButton").toggle(200),$("#msgForm").toggle(300)}),$(".fa").click(function(){$(this).closest(".panel").find(".panel-body").slideToggle(700)}),loadArticleComments()});